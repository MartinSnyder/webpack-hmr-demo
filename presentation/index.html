<!doctype html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

		<title>webpack HMR - Martin Snyder</title>

		<link rel="stylesheet" href="css/reveal.css">
		<link rel="stylesheet" href="css/theme/black.css">

		<!-- Theme used for syntax highlighting of code -->
		<link rel="stylesheet" href="lib/css/zenburn.css">

		<!-- Printing and PDF exports -->
		<script>
			var link = document.createElement( 'link' );
			link.rel = 'stylesheet';
			link.type = 'text/css';
			link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
			document.getElementsByTagName( 'head' )[0].appendChild( link );
		</script>
	</head>
	<body>
		<div class="reveal">
			<div class="slides">
				<section>
					<h3>Stop goofing around during build cycles with webpack HMR</h3>
					<p>
						<small><a href="http://martinsnyder.net">Martin Snyder</a> / <a href="https://twitter.com/MartinSnyder">@MartinSnyder</a> / <a href="http://www.wingspan.com">Wingspan Technology, Inc.</a></small>
						<img src="img/libertyjs_logo.png" />
					</p>
					<aside class="notes">
                        <ul>
                            <li>Wingspan makes document management applications for regulated industries</li>
                            <li>Direct attack on one of the best parts of software development</li>
                        </ul>
					</aside>
				</section>

                <section>
                    <h2>What is webpack HMR?</h2>
                    <p>
                        <i>"webpack HMR is a feature to inject updated modules into the active runtime."</i>
                    </p>
                    <aside class="notes">
                        <ul>
                            <li>webpack - "module bundler" packages a node project for the web</li>
                            <li>module - self-contained, isolated JavaScript nuggets</li>
                            <li>HMR - the ability to replace a module in a running application</li>
                            <li>Applies to source files, not pacakge.json or webpack.config.js</li>
                        </ul>
                    </aside>
                </section>

                <section>
                    <h2>Demo</h2>
                    <p>webpack in action</p>
                    <aside class="notes">
                        <ul>
                            <li>Injecting updated code/styles without page refresh</li>
                            <li>Show traffic in debugger</li>
                            <li>Show HMR code in bundle</li>
                        </ul>
                    </aside>
                </section>

                <section>
                    <h2>webpack Mechanics</h2>
                    <ul>
                        <li>package.json</li>
                        <li>webpack.config</li>
                        <li>webpack-dev-server</li>
                    </ul>
                    <aside class="notes">
                    </aside>
                </section>

                <section>
                    <h2>webpack HMR minimal package.json</h2>
<pre><code class="javascript">{
  ...
  "devDependencies": {
    "webpack": "^1.13.1",
    "webpack-dev-server": "^1.14.1"
  }
}
</code></pre>
                    <aside class="notes">
                    </aside>
                </section>

                <section>
                    <h2>webpack HMR typical package.json</h2>
<pre><code class="javascript">{
  ...
  "devDependencies": {
    "babel-core": "^6.10.4",
    "babel-loader": "^6.2.4",
    "babel-preset-es2015": "^6.9.0",
    "css-loader": "^0.24.0",
    "file-loader": "^0.9.0",
    "style-loader": "^0.13.1",
    "url-loader": "^0.5.7",
    "webpack": "^1.13.1",
    "webpack-dashboard": "^0.1.8",
    "webpack-dev-server": "^1.14.1"
  }
}
</code></pre>
                    <aside class="notes">
                    </aside>
                </section>

                <section>
                    <h2>webpack minimal webpack.config.js</h2>
<pre><code class="javascript">const webpack = require('webpack');

module.exports = {
    entry:  './src/index.js',
    output: {
        path:       'builds/',
        publicPath: 'http://localhost:9000/builds/',
        filename:   'bundle.js'
    },
    devServer: {
        progress: true,
        colors:   true,
        port:     9000
    },
    module: {
        loaders: [
            {
                test:    /.js$/,
                loader:  'babel',
                exclude: /node_modules/,
                query: {
                    // Needed to find presets in linked modules
                    // http://stackoverflow.com/questions/34574403/how-to-set-resolve-for-babel-loader-presets/
                    presets: ['babel-preset-es2015'].map(require.resolve)
                }
            }
        ]
    }
};
</code></pre>
                    <aside class="notes">
                    </aside>
                </section>

                <section>
                    <h2>webpack-dev-server</h2>
                    <p>
                        <img src="img/webpack-dev-server.png" />
                    </p>
                    <aside class="notes">
                    </aside>
                </section>

                <section>
                    <h2>webpack-dashboard</h2>
                    <p>
                        <img src="img/webpack-dashboard.png" />
                    </p>
                    <aside class="notes">
                    </aside>
                </section>

                <section>
                    <h2>JavaScript Mechanics</h2>
                    <ul>
                        <li>"Activating" HMR</li>
                        <li>Accommodating side effects</li>
                        <li>Preserving state</li>
                        <li>Bailing out</li>
                    </ul>
                    <aside class="notes">
                    </aside>
                </section>

                <section>
                    <h2>"Activating" HMR</h2>
<pre><code class="javascript">if (module.hot) {
    module.hot.accept();
}
</code></pre>
                    <aside class="notes">
                    </aside>
                </section>

                <section>
                    <h2>Accommodating side effects</h2>
<pre><code class="javascript">// Some operation with a side-effect (like adding a DOM element)

if (module.hot) {
    module.hot.dispose(() => {
        // Undo side effect, if possible
    });
}
</code></pre>
                    <aside class="notes">
                    </aside>
                </section>

                <section>
                    <h2>Preserving state</h2>
<pre><code class="javascript">// Initialize module state (cannot use const)
let state = {
    count: 0
};

if (module.hot) {
    // Re-assign state based on module data
    const data = module.hot.data || {};
    state = data.state || state;

    module.hot.dispose((data) => {
        // Store our retained data here so the next iteration of our module can access it
        data.state = state;
    });
}
</code></pre>
                    <aside class="notes">
                    </aside>
                </section>

                <section>
                    <h2>Bailing out</h2>
<pre><code class="javascript">import * as library from 'some-module';

library.invoke();

if (module.hot) {
    // I am not HMR safe
    module.hot.decline();

    // My dependency is not HMR safe
    module.hot.decline('some-module');
}
</code></pre>
                    <aside class="notes">
                    </aside>
                </section>

                <section>
                    <h2>Live Coding</h2>
                    <aside class="notes">
                    </aside>
                </section>

                <section>
                    <h2>Related Topics</h2>
                    <ul>
                        <li>Working with symlinked modules</li>
                        <li>Developer vs. Production builds</li>
                        <li>HMR with React.js</li>
                    </ul>
                    <aside class="notes">
                    </aside>
                </section>

                <section>
					<h1>Thank You!</h1>
					<p>
						<small><a href="http://martinsnyder.net">Martin Snyder</a> / <a href="https://twitter.com/MartinSnyder">@MartinSnyder</a> / <a href="http://www.wingspan.com">Wingspan Technology, Inc.</a></small>
						<img src="img/libertyjs_logo.png" />
					</p>
					<aside class="notes">
						<ul>
							<li>JB and the rest of the organizers</li>
							<li>LibertyJS attendees and sponsors</li>
						</ul>
					</aside>
				</section>
			</div>
		</div>

		<script src="lib/js/head.min.js"></script>
		<script src="js/reveal.js"></script>

		<script>
			// More info https://github.com/hakimel/reveal.js#configuration
			Reveal.initialize({
				history: true,

				// More info https://github.com/hakimel/reveal.js#dependencies
				dependencies: [
					{ src: 'plugin/markdown/marked.js' },
					{ src: 'plugin/markdown/markdown.js' },
					{ src: 'plugin/notes/notes.js', async: true },
					{ src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } }
				]
			});
		</script>
	</body>
</html>
